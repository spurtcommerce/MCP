{
  "version": 3,
  "sources": [],
  "sections": [
    {"offset": {"line": 7, "column": 0}, "map": {"version":3,"sources":["file:///home/pt049-poobalan-nodejs/Documents/Antlijefri/MCP/git-public/frontend/src/app/page.tsx"],"sourcesContent":["'use client';\n\nimport Link from 'next/link';\nimport React, { useState, useEffect, useRef } from 'react';\nimport { io } from 'socket.io-client';\n\ninterface Metadata {\n    [key: string]: any;\n}\n\ninterface Message {\n    role: 'user' | 'assistant' | 'tool';\n    content: string;\n    metadata?: Metadata;\n}\n\nconst socket = io(process.env.NEXT_PUBLIC_SOCKET_URL || 'http://localhost:3000');\n\nexport default function Home() {\n    const [messages, setMessages] = useState<Message[]>([]);\n    const [input, setInput] = useState('');\n    const [loading, setLoading] = useState(false);\n    const scrollRef = useRef<HTMLDivElement>(null);\n\n    useEffect(() => {\n        scrollRef.current?.scrollIntoView({ behavior: 'smooth' });\n    }, [messages]);\n\n    useEffect(() => {\n        socket.on('bot-response', (data: { text: string; metadata?: Metadata }) => {\n\n            console.log(data, 'socket-response');\n\n            const message: Message = { role: 'assistant', content: data.text, metadata: data.metadata };\n\n            setMessages((prev) => [...prev, message]);\n            setLoading(false);\n        });\n\n        return () => {\n            socket.off('bot-response');\n        };\n    }, []);\n\n    const sendMessage = () => {\n\n        if (!input.trim()) return;\n\n        const userMessage: Message = { role: 'user', content: input };\n\n        console.log(messages, 'messages');\n\n        const updatedMessages = [...messages, userMessage];\n        setMessages(updatedMessages);\n        setInput('');\n        setLoading(true);\n\n        // ❗ Only send clean messages (strip metadata)\n        const contextForServer = updatedMessages.map(({ role, content }) => ({\n            role,\n            content,\n        }));\n\n        socket.emit('user-message', {\n            query: input,\n            context: contextForServer,\n        });\n    };\n\n\n    return (\n        <section className=' h-screen flex flex-col'>\n            <header className='p-[16px_40px] border-b border-solid border-[#EFEFEF] flex items-center justify-between'>\n                <h1 className=\"text-[20px] font-semibold text-[#171D26]\">\n                    Spurtcommerce Assistant\n                </h1>\n                <a\n                    href=\"\"\n                    className='ms-auto text-[14px] h-[32px] leading-[19px] font-normal text-[#FFFFFF] bg-[#171D26] rounded-[8px] p-[6px_12px] hover:bg-black'\n                >\n                    Login\n                </a>\n            </header>\n            <div className='p-4 flex flex-col grow h-[calc(100%-65px)]'>\n                <div className=\"max-w-[800px] mx-auto flex flex-col h-full\">\n                    {['', null, undefined, 0].includes(messages.length) && <h1 className='text-[25px] leading-[30px] text-center font-medium text-[#282322] m-[80px_20px_20px]'>Hi there. What's in your mind  today ?</h1>}\n\n                    {/* Chat Messages */}\n                    <div className=\"flex-1 flex flex-col overflow-y-auto pb-[42px] gap-y-6 scrollbar-none\">\n                        {messages.map((msg, i) =>\n                            msg.role !== 'tool' ? (\n                                <div key={i} className={`flex ${msg.role === 'user' ? 'justify-end' : 'justify-start'}`}>\n                                    <div\n                                        className={` text-sm  leading-[19px] font-normal text-[#171D26]  rounded-[8px] whitespace-pre-wrap capitalize ${msg.role === 'user' ? 'bg-[#F4F4F4] p-[12px] w-max max-w-[80%]' : 'bg-white w-full'\n                                            }`}\n                                    >\n                                        {msg.content}\n                                        {msg.metadata?.data?.length > 0 && (\n                                            <div className='mt-6 relative after:w-[48px] after:h-full after:inline-block after:absolute after:top-0 after:right-0 after:bg-[linear-gradient(89deg,_#ffffff00_0%,_#ffffff_100%)] overflow-hidden'>\n                                                <div className=\"flex no-wrap gap-[16px] overflow-auto scrollbar-none \">\n                                                    {msg.metadata?.data?.map((product: any, index: number) => (\n                                                        <div\n                                                            key={index}\n                                                            className=\"min-w-[200px] w-[200px] h-[312px] border border-solid border-[#E6E6EB] rounded-[8px] flex flex-col\"\n                                                        >\n                                                            {/* Static image for now */}\n                                                            <div className='grow p-[8px_8px_0px_8px]'>\n                                                                <img\n                                                                    src={product.imageUrl}\n                                                                    alt={product.name}\n                                                                    className=\"w-full h-full object-contain\"\n                                                                />\n                                                            </div>\n                                                            <div className='p-[8px] mt-auto'>\n                                                                <div className=\"text-[14px] leading-[19px] font-normal text-[#171D26] mb-1 line-clamp-2\">{product.name}</div>\n                                                                <div className=\"text-[14px] leading-[19px] font-semibold text-[#171D26] mb-2\">₹ {product.price}</div>\n                                                                <Link href={product.redirectUrl ?? ''} target=\"_blank\" rel=\"noopener noreferrer\">\n                                                                    <button className=\" cursor-pointer pt-2 border-t border-solid border-[#E6E6EB] text-[#1168F4] text-[14px] leading-[19px] block w-full hover:underline font-normal\">\n                                                                        Buy now\n                                                                    </button>\n                                                                </Link>\n\n                                                            </div>\n                                                        </div>\n                                                    ))}\n                                                </div>\n                                            </div>\n                                        )}\n                                    </div>\n                                </div>\n                            ) : null\n                        )}\n                        <div ref={scrollRef} />\n                    </div>\n\n                    {/* Input Box */}\n                    <div className='relative  after:h-[48px] after:w-full after:inline-block after:absolute after:bottom-full after:right-0 after:bg-[linear-gradient(180deg,_#ffffff00_0%,_#ffffff_100%)] '>\n                        {['', null, undefined, 0].includes(messages.length) && <ul className='flex items-center gap-[8px] flex-wrap justify-center mb-[16px]'>\n                            <li><a href=\"\" className='text-[14px] leading-[19px] font-normal text-[#171D26] p-[12px_6px] border border-solid border-[#E6E6EB] rounded-[8px] block w-max'>Which items have the best reviews?</a></li>\n                            <li><a href=\"\" className='text-[14px] leading-[19px] font-normal text-[#171D26] p-[12px_6px] border border-solid border-[#E6E6EB] rounded-[8px] block w-max'>What payment methods do you accept?</a></li>\n                            <li><a href=\"\" className='text-[14px] leading-[19px] font-normal text-[#171D26] p-[12px_6px] border border-solid border-[#E6E6EB] rounded-[8px] block w-max'>What’s trending right now?</a></li>\n                            <li><a href=\"\" className='text-[14px] leading-[19px] font-normal text-[#171D26] p-[12px_6px] border border-solid border-[#E6E6EB] rounded-[8px] block w-max'>Which products are most frequently re-ordered?</a></li>\n                            <li><a href=\"\" className='text-[14px] leading-[19px] font-normal text-[#171D26] p-[12px_6px] border border-solid border-[#E6E6EB] rounded-[8px] block w-max'>Which product has high repeat purchase rate?</a></li>\n                        </ul>}\n\n\n                        <div className=\" flex flex-col items-end space-y-2 h-[128px] border border-solid\n                 border-[#E6E6EB] rounded-[8px] p-[12px]\">\n                            <input\n                                value={input}\n                                onChange={(e) => setInput(e.target.value)}\n                                onKeyDown={(e) => e.key === 'Enter' && sendMessage()}\n                                placeholder=\"Need help? Ask AI Anything!\"\n                                className=\"p-0 placeholder:absolute placeholder:top-0 relative m-0 w-full grow text-[14px] leading-[19px] font-normal focus:outline-none focus:shadow-none placeholder:text-[#989898]\"\n                            />\n\n                            {/* <textarea\n                            value={input}\n                            onChange={(e) => setInput(e.target.value)}\n                            onKeyDown={(e) => e.key === 'Enter' && !e.shiftKey && (e.preventDefault(), sendMessage())}\n                            placeholder=\"Need help? Ask AI Anything!\"\n                            className=\"p-0 placeholder:absolute scrollbar-thin placeholder:top-0 relative m-0 w-full grow text-[14px] leading-[19px] font-normal focus:outline-none focus:shadow-none placeholder:text-[#989898] resize-none\"\n                        /> */}\n\n                            <button\n                                onClick={sendMessage}\n                                disabled={loading}\n                                className=\"bg-[#171D26] scrollbar-thin hover:bg-black cursor-pointer w-[36px] h-[36px] min-w-[36px] rounded-full grid place-items-center disabled:opacity-50\"\n                            >\n                                {/* {loading ? 'Thinking…' : 'Send'} */}\n                                <img src=\"/img/send.svg\" alt=\"send\" />\n                            </button>\n                        </div>\n                        <p className='text-[12px] leading-[17px] font-normal text-[#999999] mt-[16px] text-center'>By messaging ZayaBot, you agree to our <a href=\"\" className='underline hover:text-[#171D26]'>Terms of Service</a> and have read our <a href=\"\" className='underline hover:text-[#171D26]'>Privacy Policy</a>.</p>\n\n                    </div>\n                </div>\n            </div>\n        </section>\n\n    );\n}\n"],"names":[],"mappings":"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","debugId":null}}]
}